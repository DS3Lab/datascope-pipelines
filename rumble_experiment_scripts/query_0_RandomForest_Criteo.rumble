%%rumble
let $training-data := parquet-file("s3://rumbleml-data/output/output.parquet/")
let $test-data := parquet-file("s3://rumbleml-data/criteo.test.parquet")
let $vector-assembler_2 := get-transformer("VectorAssembler", {"inputCols" : ["features"], "outputCol" : "transformedFeatures"})
let $randomforest := get-estimator("RandomForestClassifier", {"featuresCol": "transformedFeatures"})
let $pipeline := get-estimator("Pipeline", {"stages": [$vector-assembler_2, $randomforest]})
let $pip := $pipeline($training-data, {})
let $total := 6042135
return count($prediction[$$.label eq $$.prediction]) div $total